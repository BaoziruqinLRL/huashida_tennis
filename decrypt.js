const CryptoJS = require('crypto-js');

// const key = 'X9YEj3qsS1lSfgge+IlZXw==';
// const key = 'ed79fe80db6ac20357e5f39fb42bda73c270d1258d9b81385ae0eb12fe4c6e2b'
const key = '7c8f60274e0850188c37b44ca2d5291b91a2468012c44d971bf62df8d81c99fc'

function decryptData(da, ivRaw) {
  const hexdata = CryptoJS.enc.Hex.parse(da)
  const basedata = CryptoJS.enc.Base64.stringify(hexdata)
  // 解密数据
  const bytes = CryptoJS.AES.decrypt(basedata, CryptoJS.enc.Utf8.parse(key), {
    iv: CryptoJS.enc.Utf8.parse(ivRaw),
    mode: CryptoJS.mode.CBC,
    padding: CryptoJS.pad.Pkcs7
  });
  // 将解密后的数据转换为原始形式
  const toS = bytes.toString(CryptoJS.enc.Utf8)
  const decryptedData = JSON.parse(toS);
  return decryptedData
}

console.info(JSON.stringify(decryptData(
  "4bb8790d1ad4cb920e4d859d98286508e3f207b970c9dd4b8aa355783723f84f536ae9e324eb91e608fd8461a4f3ac94daf0af1fb411c62435750cccfddb453d62d5c93b6e549c0ecaba024387cd0b76421614a236bc15deed2c760a73e916444184948cadc0ca28a2b7e1f8cb68accd5ce02893f1b09bf62a0938d7aa10712ba309dca40d99e8e4522ebcc54847d693888c39e78c0c7f0cccf753a0d4e3f001284b4ba8b1ae7312b7736cef8b5ce9170b7526cb9e4a3ed77aafdf96de5a43433a3a757df4dec8922ac6feda0af83c331f27a2d46b392904b5077989625cb72cfecb79a2d54e30ca223593f31910301e03df1afe8f706f68e7b91d6b7d5a1e8d2690287f52bb55e1de9a1d0c9522711eee5c1b0b93536789e5e7fab8e901c46576fe892b227035269fa210680790a9f5cb80c346d3b1908e6aafe61fccd2b37bb81266c1e504b74b4cd54f6d48afaddc7ece73d6508f5feca0c50943ba0f8dbcf19e5f072c6af1231f7b90ed4ab463bef14fdd4e0d16a50528f81a659c7127e93204ec09cd0872b47a2b9715d10d27cbb84dced40d2872221fcbefb4058672b8e8cce04f7c68191156a9e40d3086da08f8ba3ea611a37f518e52568b1e6d7b64ba035cadcfe56236af6477c5be020fa6ed649be5a9b12804013359bcfc1042bd34ccd06850eab4b43f8c2ee909896189b2efaa3ef20ed2c54c273df7ed01fe9bcea84a45dad5c30605ed35676d70ff5e4431a4bf7318a3e56b615a94c1530c065a7ac8a9c3150df3c15949815e63e563dc19000a550fcf82d2935f82e54462dab3bb3570d49084a64be41ceb65a8dfe2c03903e623f41c83951084d11fd833498c3534513e0d8ee1f6258a9e8f24a89ee2f2114b01b520c7d1640fa0943699f3536ebdc3c0f6efb3798d88297e4ce32091e31b28d9592e6e820df04a5d0af130f5b29bab44d9a02a1888199bdac1c2c72520c54ce96cdf78916082ce3b01be2aa664b7d9f294970b25668fe1a56da79793f87e953da1e0021b269e4f090bd575442182c2fb3770d6182fe20bce0d7086e014fcbda1d97c5b364b7da6992fa61706c98f4d9a4487bf45cabf4990b3a6123f22281cb960a46708be4ce1b9ce2d5b5f20d0aeef596a397ff8d9f5ffac377af7ac9a74763af27002ddd7a875cd849d91ddf9de9ea9811ceed763ce52877f84ebf1e4530ce5ac36c1078c2624ba08a9817af675493fbb3bad7819d38a87eec37f7888241fb9097001db932f151c60d8f3b6742bf8cc9654610f20e2c2abdc669f0ba8a7a45d55a6b050584bcd8de73b5dce4575fb55b077df4b6d32a04ee4b1cfa44253f57c159c98d47e1d11ecf51c5be857628502f7271ba397b0bbd4ffc4afd1d6fdfeccf482730b5e2e69ea5fae0038a9290b1858c14439e51f51fb7ff0b700e456d79d13fb5d616f6f2ae3d520173429a6a040b150619b08632bae28f45043de62119d076001d6621d1ef74ccd27f8916d61a2024f0b27789191523a472e9f1b0b666052085fdbc373e235edd51ea12692189667dbe30f9587ae511649c1bbd1e09d24784973f0298ca98489d373027104ae5af000bbd646012e991d71d68efe934b05030f4444ccddca4cc10727803ad7eb54d2096986fa6e615dd31fffba5c2d13feb3a05f245c1eb89e46208c8f0bac439f81b01b26014f1183d35e0e5f8b33542ce20a94cf4aab75e9f0dd7fbcc86f8a34d76f175072f4f31827ebfdb6239db064d6b6598535c675849012eebeed932fbd24f2094256d3cc3a5d86f1e17e80290747f4ed00bd9d8fbc030e4ef0490e6babab66329b419760521a2df26f56aeaaf71cb0c991c127ba048f7f11b6bf35960ecb94dc89652f241d84ee9c0f18e1817707a29e55981c671f4658a7a3d2548c8a524c3e102bc3607e3c687fdc19506dc7dddc89cd4e0261d042b7a297ac79b780fed6b03a5823e9d35e36680f3ad44db194374f71aa696f4c3a1507ac8df51a1ea5de0d06877a7601109bd0b7e9a41403b4efd8d6bc0f4e7476a8b8c4acec3a7c1c3ead795735114d96625252c42e435ea84a6a38c1d2189c9f615169d4cf06664e1793b5574298f28b9147d97270d83cc976ced24c360d8da4fcf9f32672c1a5e763a2cd4f6492cf9a45ffb017418ad886dc2323de2c09922a99b7857026e53b9de4019f763b156cf0d202992c05ee27cebe0e813a579c86bc37a03d01c4600020744fbf871f9d713ba57eced47a64e53033a5c149dc8364705f07ca79f0ad4f71ee2b89be745cfd43c444f0c354c42396ac86e5c368463391bc249c7f28b9a33430fc32b0b90f560f40f7454bad35ceac4ae99fb0c8f82b4aa9d7698659c94a896e3d74db3637539c17545ed0878580ced346af883b3c750e363d3a38df437e93fd01733c77af38f35e3b33e6ed0f10446b872620d27d648a7eac4e979d175f45eaae4536182895d9d8cf00bf15e013fd5b7db8af0096c512f632d6f6005c85b6753c47e7be1e4734ecb4074328fbec41536cfee8083e4acd78",
  '21f61b509c238ed2'
)));

module.exports = {
  decryptData
}